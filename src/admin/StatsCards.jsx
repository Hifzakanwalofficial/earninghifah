// src/components/StatsCards.jsx
import React, { useEffect, useState } from "react";
import { Baseurl } from "../Config";

// Shimmer Skeleton (unchanged)
const ShimmerCard = () => (
  <div className="bg-white dark:bg-[#080F25] px-[14px] py-[24px] rounded-xl shadow animate-pulse flex items-center justify-between">
    <div className="space-y-2 w-full">
      <div className="h-4 bg-gray-300 dark:bg-gray-700 rounded w-1/2"></div>
      <div className="h-8 bg-gray-300 dark:bg-gray-700 rounded w-3/4"></div>
    </div>
    <div className='bg-gray-300 dark:bg-gray-700 h-[40px] w-[40px] rounded-full'></div>
  </div>
);

const StatsCards = ({ fromDate, toDate }) => {
  const [stats, setStats] = useState(null);
  const [loading, setLoading] = useState(true);

  // Fetch Stats with Date Filter - FIXED: No +1 day anymore
  const fetchStats = async () => {
    setLoading(true);
    try {
      const token = localStorage.getItem("authToken");
      if (!token) throw new Error("No token found, please login again.");

      const url = new URL(`${Baseurl}/admin/drivers/stats`);

      // Use exact dates â€” no artificial +1 day
      let effectiveToDate = toDate;
      if (!toDate && fromDate) {
        effectiveToDate = fromDate; // single date case
      }

      if (fromDate) url.searchParams.append("startDate", fromDate);
      if (effectiveToDate) url.searchParams.append("endDate", effectiveToDate);

      console.log("Fetching stats with URL:", url.toString()); // Debug log

      const res = await fetch(url, {
        headers: {
          Authorization: `Bearer ${token}`,
          "Content-Type": "application/json",
        },
      });

      if (!res.ok) throw new Error("Failed to fetch stats");

      const data = await res.json();
      console.log("Stats data received:", data); // Debug log

      if (data?.totals) {
        setStats([
          {
            title: "Total Calls",
            value: data.totals.totalCalls || 0,
            icon: (
              <svg
                width="21"
                height="20"
                viewBox="0 0 21 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12.2074 5.00008C13.0213 5.15889 13.2713 5.55696 13.8577 6.14336C14.4441 6.72976 14.8422 7.4778 15.001 8.29175M12.2074 1.66675C13.4004 1.85461 14.9773 2.61189 16.1812 3.81425C17.3851 5.01662 18.1444 6.59259 18.3344 8.28341M8.5235 11.5526C7.52219 10.5513 6.73153 9.41912 6.15153 8.21111C6.10164 8.1072 6.0767 8.05524 6.05753 7.9895C5.98943 7.75587 6.03835 7.46899 6.18003 7.27113C6.21989 7.21546 6.26752 7.16783 6.36278 7.07257C6.65412 6.78123 6.79979 6.63556 6.89503 6.48908C7.25419 5.93667 7.25419 5.22452 6.89503 4.67211C6.79979 4.52563 6.65412 4.37996 6.36278 4.08862L6.20039 3.92623C5.75752 3.48336 5.53609 3.26192 5.29827 3.14164C4.8253 2.90241 4.26675 2.90241 3.79378 3.14164C3.55596 3.26192 3.33453 3.48336 2.89166 3.92623L2.7603 4.05759C2.31895 4.49894 2.09827 4.71962 1.92973 5.01964C1.74271 5.35257 1.60825 5.86964 1.60938 6.25149C1.61041 6.59562 1.67716 6.8308 1.81067 7.30117C2.52814 9.82901 3.88187 12.2143 5.87185 14.2043C7.86184 16.1943 10.2471 17.548 12.775 18.2655C13.2453 18.399 13.4805 18.4657 13.8246 18.4668C14.2065 18.4679 14.7236 18.3334 15.0565 18.1464C15.3565 17.9779 15.5772 17.7572 16.0186 17.3158L16.1499 17.1845C16.5928 16.7416 16.8142 16.5202 16.9345 16.2824C17.1737 15.8094 17.1737 15.2508 16.9345 14.7779C16.8142 14.5401 16.5928 14.3186 16.1499 13.8758L15.9875 13.7134C15.6962 13.422 15.5505 13.2764 15.404 13.1811C14.8516 12.8219 14.1395 12.822 13.5871 13.1811C13.4406 13.2764 13.2949 13.422 13.0036 13.7134C12.9083 13.8086 12.8607 13.8562 12.805 13.8961C12.6072 14.0378 12.3203 14.0867 12.0866 14.0186C12.0209 13.9994 11.9689 13.9745 11.865 13.9246C10.657 13.3446 9.52482 12.554 8.5235 11.5526Z"
                  stroke="#0078BD"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            ),
          },
          {
            title: "Total REMS",
            value: data.totals.totalRems ? data.totals.totalRems.toFixed(2) : "0.00",
            icon: (
              <svg
                width="21"
                height="20"
                viewBox="0 0 21 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M8.46855 0.429688C8.39824 0.5 8.39043 0.558594 8.39043 1.14453V1.77734L8.03105 1.87109C7.36308 2.03906 6.63261 2.34766 6.02714 2.71094L5.79277 2.85156L5.38261 2.44531C5.15605 2.22266 4.93339 2.01953 4.88261 1.99219C4.69511 1.89844 4.60136 1.96875 3.69121 2.88281C2.88652 3.69141 2.80449 3.78516 2.80449 3.90625C2.80449 4.01953 2.85918 4.09375 3.2498 4.48828L3.69511 4.94141L3.49589 5.27344C3.15605 5.83984 2.74199 6.89062 2.66386 7.37891L2.63652 7.53906H2.03886C1.39824 7.53906 1.27714 7.56641 1.20683 7.72266C1.17949 7.78516 1.16386 8.22656 1.16386 9.03906C1.16386 10.6016 1.08574 10.4648 1.97246 10.4766L2.62089 10.4883L2.73027 10.8984C2.78886 11.125 2.90214 11.4766 2.98027 11.6797C3.12089 12.0469 3.48808 12.7773 3.6248 12.9688L3.69511 13.0664L3.2498 13.5234C2.86308 13.918 2.80449 13.9961 2.80449 14.1055C2.80449 14.2227 2.89824 14.3281 3.71074 15.1445C4.54277 15.9805 4.62871 16.0547 4.75371 16.0547C4.87089 16.0547 4.94121 16.0039 5.33964 15.6094L5.79277 15.1602L5.89043 15.2344C6.09746 15.3828 6.52324 15.5938 6.55058 15.5625C6.65214 15.4492 7.64824 13.7305 7.62089 13.7227C7.60136 13.7148 7.44511 13.6289 7.27714 13.5352C5.96464 12.7852 5.03496 11.4883 4.73027 9.96875C4.63652 9.49609 4.63652 8.50391 4.73027 8.04688C5.18339 5.89062 6.80449 4.28906 8.9373 3.88672C9.4373 3.78906 10.2732 3.78906 10.7732 3.88672C12.6561 4.24609 14.199 5.57812 14.7928 7.36719C14.9998 7.98438 15.0428 8.28125 15.0506 9.01562L15.0545 9.69531L15.7771 10.8984C16.1717 11.5625 16.5154 12.1016 16.535 12.0938C16.5936 12.0781 16.8592 11.3711 16.9803 10.9023L17.0896 10.4883L17.7381 10.4766C18.6248 10.4648 18.5467 10.6016 18.5467 9.03906C18.5467 8.22656 18.531 7.78516 18.5037 7.72266C18.4334 7.56641 18.3123 7.53906 17.6717 7.53906H17.074L17.0467 7.37891C16.9686 6.89062 16.5545 5.83984 16.2146 5.27344L16.0154 4.94141L16.4607 4.48828C16.8514 4.09375 16.9061 4.01953 16.9061 3.90625C16.9061 3.78516 16.824 3.69141 16.0193 2.88281C15.1092 1.96875 15.0154 1.89844 14.8279 1.99219C14.7771 2.01953 14.5545 2.22266 14.3279 2.44531L13.9139 2.85156L13.7264 2.73438C13.1951 2.39844 12.3084 2.02344 11.6717 1.86719L11.3201 1.78125V1.14453C11.3201 0.558594 11.3123 0.5 11.242 0.429688C11.1678 0.355469 11.1131 0.351562 9.85527 0.351562C8.59746 0.351562 8.54277 0.355469 8.46855 0.429688Z"
                  fill="#0078BD"
                />
                <path
                  d="M12.9964 10.0234C13.2582 10.1562 13.3988 10.3594 13.4222 10.6367C13.4339 10.8203 13.1488 15.3242 13.0941 15.7383C13.0472 16.0898 12.6996 16.2891 12.3636 16.1562C12.1683 16.0781 12.0628 15.9453 12.0355 15.75C12.0277 15.6719 11.9418 14.4961 11.848 13.1367C11.6605 10.3672 11.6566 10.4414 11.9222 10.1758C12.1996 9.90234 12.6253 9.83984 12.9964 10.0234ZM12.8832 17.2266C13.3753 17.4766 13.3714 18.1875 12.8753 18.4414C12.6722 18.543 12.348 18.5312 12.1878 18.4102C11.8363 18.1523 11.7777 17.7031 12.0511 17.3789C12.2503 17.1445 12.598 17.082 12.8832 17.2266Z"
                  fill="#0078BD"
                />
              </svg>
            ),
          },
          {
            title: "Total RPM",
            value: data.totals.totalRpm ? data.totals.totalRpm.toFixed(2) : "0.00",
            icon: (
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M9.15929 5.4375C6.65148 5.6875 4.3546 7.08203 2.96398 9.1875C2.33117 10.1484 1.84288 11.4141 1.67882 12.5C1.65538 12.6602 1.62804 12.8516 1.61632 12.918C1.6046 13.0117 1.61242 13.0469 1.65148 13.0469C1.68663 13.0469 1.7296 12.9375 1.77257 12.7266C1.93663 11.9766 2.35851 10.9883 2.7921 10.3516C4.00304 8.57031 5.90929 7.46484 8.0382 7.30859C10.0655 7.15625 12.1671 7.99609 13.5382 9.50781C13.6866 9.67188 13.8234 9.80469 13.8468 9.80469C13.8898 9.80469 16.5773 8.76562 16.6749 8.71484C16.7843 8.65234 15.964 7.77344 15.2726 7.21484C13.6319 5.89062 11.3273 5.21875 9.15929 5.4375Z"
                  fill="#0078BD"
                />
                <path
                  d="M13.6211 10.5273L10 11.9453L9.63672 11.9414C9.17969 11.9375 8.91016 12.0352 8.64062 12.2969C8.34375 12.5898 8.26172 12.793 8.26172 13.2617C8.26172 13.5898 8.27734 13.6797 8.35156 13.832C8.49609 14.125 8.69141 14.3203 8.97656 14.4609C9.21094 14.5781 9.26953 14.5898 9.57031 14.5898C9.84375 14.5898 9.94141 14.5703 10.1172 14.4883C10.4141 14.3516 10.5898 14.1875 10.7344 13.9141L10.8594 13.6797L13.582 11.793C15.082 10.7578 16.5352 9.74609 16.8164 9.55469C17.2734 9.23438 17.375 9.13672 17.2773 9.11719C17.2617 9.11328 15.6172 9.75 13.6211 10.5273Z"
                  fill="#0078BD"
                />
                <path
                  d="M16.1445 10.7148C15.4531 11.1914 14.8867 11.6055 14.8828 11.6367C14.8828 11.6641 14.9258 11.8086 14.9766 11.9492C15.1094 12.3203 15.2734 13.0703 15.3008 13.4492C15.3125 13.625 15.3398 13.8086 15.3555 13.8555L15.3906 13.9453H16.8516C18.1094 13.9453 18.3164 13.9375 18.3594 13.8867C18.4687 13.7578 18.3281 12.3867 18.125 11.5898C17.9648 10.957 17.5234 9.84375 17.4297 9.84375C17.4141 9.84375 16.8359 10.2344 16.1445 10.7148Z"
                  fill="#0078BD"
                />
              </svg>
            ),
          },
          {
            title: "Total PR1",
            value: data.totals.totalPr1 ? data.totals.totalPr1.toFixed(2) : "0.00",
            icon: (
              <svg
                width="21"
                height="20"
                viewBox="0 0 21 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g clipPath="url(#clip0_915_7372)">
                  <path
                    d="M18.0508 0.078125C17.2617 0.285156 16.3555 0.839844 15.5469 1.62109C15.2109 1.94141 14.6445 2.58984 14.582 2.72266C14.582 2.72656 13.7891 2.54688 12.8242 2.32422L11.0664 1.91797L5.78125 7.19922C2.87891 10.1055 0.5 12.4961 0.5 12.5195C0.5 12.5703 7.92969 20 7.98047 20C8.00391 20 10.3984 17.6211 13.3008 14.7188L18.582 9.43359L18.1797 7.67578C17.9531 6.71094 17.7734 5.91797 17.7773 5.91406C17.7812 5.91406 17.9336 5.79688 18.1172 5.65625C19.2539 4.78125 20.1602 3.5 20.4219 2.40625C20.5195 2.01172 20.5234 1.42969 20.4375 1.12891C20.2812 0.601562 19.8945 0.226562 19.332 0.0625C19.0352 -0.0234375 18.4141 -0.015625 18.0508 0.078125ZM19.0977 1.26953C19.5156 1.48828 19.2539 2.52734 18.5352 3.5C18.4258 3.64844 18.1445 3.96094 17.9062 4.19922L17.4766 4.62891L17.4297 4.43359C17.4023 4.32422 17.3359 4.03516 17.2773 3.78516L17.1758 3.32812L16.7969 3.24219C16.5898 3.19531 16.2969 3.12891 16.1523 3.08984L15.8828 3.02734L16.1445 2.74609C17.1211 1.6875 18.5391 0.980469 19.0977 1.26953ZM12.7539 3.55859C13.4141 3.71094 13.9609 3.83984 13.9648 3.84375C13.9688 3.84766 13.9258 3.99219 13.8711 4.16016C13.7812 4.43359 13.7656 4.53906 13.7656 5C13.7617 5.57422 13.8086 5.77734 14.0117 6.07422C14.2031 6.35547 14.2031 6.35547 14.6602 5.89453L15.0742 5.48438L15.0156 5.36719C14.9805 5.30469 14.9531 5.15625 14.9531 5.03125C14.9531 4.78125 15.125 4.1875 15.2031 4.15625C15.2422 4.14062 16.1211 4.32031 16.1523 4.34766C16.1562 4.35156 16.4023 5.41406 16.6992 6.70703L17.2422 9.05859L16.7734 9.52734L16.3008 10L13.4102 7.10938L10.5195 4.21875L10.9883 3.75C11.2461 3.49219 11.4766 3.28125 11.5039 3.28125C11.5273 3.28125 12.0898 3.40625 12.7539 3.55859ZM11.7227 14.5781L8 18.3008L5.10938 15.4102L2.21875 12.5195L5.9375 8.80078L9.66016 5.07812L12.5508 7.96875L15.4414 10.8594L11.7227 14.5781Z"
                    fill="#0078BD"
                  />
                  <path
                    d="M10.8281 8.79297L10.3945 9.22656L10.2578 9.18359C9.56641 8.95703 8.80859 9.13672 8.34766 9.64062C7.71875 10.3281 7.70703 11.332 8.32812 12.0703C8.42578 12.1875 8.51953 12.3438 8.53125 12.4141C8.61328 12.8516 8.14844 13.2148 7.75 13.0273C7.55859 12.9375 7.44531 12.7656 7.42188 12.5352C7.40625 12.3477 7.39844 12.3438 7.24219 12.3008C6.61719 12.1289 6.25781 12.043 6.24219 12.0586C6.23047 12.0664 6.22266 12.2734 6.22266 12.5117C6.22656 12.8438 6.24219 12.9883 6.29297 13.1055L6.36328 13.2578L5.90234 13.7188L5.44141 14.1797L5.88281 14.6172L6.32031 15.0586L6.77734 14.6016L7.23828 14.1484L7.39453 14.207C7.61719 14.2891 8.09766 14.3164 8.35938 14.2617C9.00391 14.125 9.53516 13.6133 9.70312 12.9688C9.82422 12.4883 9.71875 11.8711 9.45312 11.5195C9.39453 11.4414 9.28906 11.3047 9.22266 11.2109C8.92188 10.8164 9.16406 10.3125 9.64844 10.3125C9.96484 10.3125 10.1875 10.5391 10.2031 10.875L10.2109 11.0352L10.7695 11.1836C11.1523 11.2852 11.3438 11.3203 11.3711 11.293C11.4375 11.2266 11.4219 10.5898 11.3438 10.3359L11.2773 10.1055L11.707 9.67188C11.9453 9.43359 12.1406 9.21875 12.1406 9.19922C12.1406 9.14844 11.3516 8.35938 11.3008 8.35938C11.2773 8.35938 11.0664 8.55469 10.8281 8.79297Z"
                    fill="#0078BD"
                  />
                </g>
                <defs>
                  <clipPath id="clip0_915_7372">
                    <rect width="20" height="20" fill="white" transform="translate(0.5)" />
                  </clipPath>
                </defs>
              </svg>
            ),
          },
          {
            title: "Total Earnings",
            value: `$${Number(data.totals.netEarnings || 0).toFixed(2)}`,
            icon: (
              <svg
                width="22"
                height="22"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20Z"
                  fill="#0078BD"
                />
                <path
                  d="M13.5 7H10.5C10.09 7 9.75 7.34 9.75 7.75V16.25C9.75 16.66 10.09 17 10.5 17H13.5C13.91 17 14.25 16.66 14.25 16.25V7.75C14.25 7.34 13.91 7 13.5 7Z"
                  fill="#0078BD"
                />
                <path
                  d="M12.75 9.5H15.25C15.66 9.5 16 9.84 16 10.25V13.75C16 14.16 15.66 14.5 15.25 14.5H12.75C12.34 14.5 12 14.16 12 13.75V10.25C12 9.84 12.34 9.5 12.75 9.5Z"
                  fill="#0078BD"
                />
                <path
                  d="M11.25 9.5H8.75C8.34 9.5 8 9.84 8 10.25V13.75C8 14.16 8.34 14.5 8.75 14.5H11.25C11.66 14.5 12 14.16 12 13.75V10.25C12 9.84 11.66 9.5 11.25 9.5Z"
                  fill="#0078BD"
                />
              </svg>
            ),
          },
        ]);
      } else {
        // Fallback when no totals (unchanged)
        console.error("Unexpected API response format:", data);
        setStats([
          {
            title: "Total Calls",
            value: "0",
            icon: (
              <svg
                width="21"
                height="20"
                viewBox="0 0 21 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12.2074 5.00008C13.0213 5.15889 13.2713 5.55696 13.8577 6.14336C14.4441 6.72976 14.8422 7.4778 15.001 8.29175M12.2074 1.66675C13.4004 1.85461 14.9773 2.61189 16.1812 3.81425C17.3851 5.01662 18.1444 6.59259 18.3344 8.28341M8.5235 11.5526C7.52219 10.5513 6.73153 9.41912 6.15153 8.21111C6.10164 8.1072 6.0767 8.05524 6.05753 7.9895C5.98943 7.75587 6.03835 7.46899 6.18003 7.27113C6.21989 7.21546 6.26752 7.16783 6.36278 7.07257C6.65412 6.78123 6.79979 6.63556 6.89503 6.48908C7.25419 5.93667 7.25419 5.22452 6.89503 4.67211C6.79979 4.52563 6.65412 4.37996 6.36278 4.08862L6.20039 3.92623C5.75752 3.48336 5.53609 3.26192 5.29827 3.14164C4.8253 2.90241 4.26675 2.90241 3.79378 3.14164C3.55596 3.26192 3.33453 3.48336 2.89166 3.92623L2.7603 4.05759C2.31895 4.49894 2.09827 4.71962 1.92973 5.01964C1.74271 5.35257 1.60825 5.86964 1.60938 6.25149C1.61041 6.59562 1.67716 6.8308 1.81067 7.30117C2.52814 9.82901 3.88187 12.2143 5.87185 14.2043C7.86184 16.1943 10.2471 17.548 12.775 18.2655C13.2453 18.399 13.4805 18.4657 13.8246 18.4668C14.2065 18.4679 14.7236 18.3334 15.0565 18.1464C15.3565 17.9779 15.5772 17.7572 16.0186 17.3158L16.1499 17.1845C16.5928 16.7416 16.8142 16.5202 16.9345 16.2824C17.1737 15.8094 17.1737 15.2508 16.9345 14.7779C16.8142 14.5401 16.5928 14.3186 16.1499 13.8758L15.9875 13.7134C15.6962 13.422 15.5505 13.2764 15.404 13.1811C14.8516 12.8219 14.1395 12.822 13.5871 13.1811C13.4406 13.2764 13.2949 13.422 13.0036 13.7134C12.9083 13.8086 12.8607 13.8562 12.805 13.8961C12.6072 14.0378 12.3203 14.0867 12.0866 14.0186C12.0209 13.9994 11.9689 13.9745 11.865 13.9246C10.657 13.3446 9.52482 12.554 8.5235 11.5526Z"
                  stroke="#0078BD"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            ),
          },
          {
            title: "Total REMS",
            value: "0.00",
            icon: (
              <svg
                width="21"
                height="20"
                viewBox="0 0 21 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M8.46855 0.429688C8.39824 0.5 8.39043 0.558594 8.39043 1.14453V1.77734L8.03105 1.87109C7.36308 2.03906 6.63261 2.34766 6.02714 2.71094L5.79277 2.85156L5.38261 2.44531C5.15605 2.22266 4.93339 2.01953 4.88261 1.99219C4.69511 1.89844 4.60136 1.96875 3.69121 2.88281C2.88652 3.69141 2.80449 3.78516 2.80449 3.90625C2.80449 4.01953 2.85918 4.09375 3.2498 4.48828L3.69511 4.94141L3.49589 5.27344C3.15605 5.83984 2.74199 6.89062 2.66386 7.37891L2.63652 7.53906H2.03886C1.39824 7.53906 1.27714 7.56641 1.20683 7.72266C1.17949 7.78516 1.16386 8.22656 1.16386 9.03906C1.16386 10.6016 1.08574 10.4648 1.97246 10.4766L2.62089 10.4883L2.73027 10.8984C2.78886 11.125 2.90214 11.4766 2.98027 11.6797C3.12089 12.0469 3.48808 12.7773 3.6248 12.9688L3.69511 13.0664L3.2498 13.5234C2.86308 13.918 2.80449 13.9961 2.80449 14.1055C2.80449 14.2227 2.89824 14.3281 3.71074 15.1445C4.54277 15.9805 4.62871 16.0547 4.75371 16.0547C4.87089 16.0547 4.94121 16.0039 5.33964 15.6094L5.79277 15.1602L5.89043 15.2344C6.09746 15.3828 6.52324 15.5938 6.55058 15.5625C6.65214 15.4492 7.64824 13.7305 7.62089 13.7227C7.60136 13.7148 7.44511 13.6289 7.27714 13.5352C5.96464 12.7852 5.03496 11.4883 4.73027 9.96875C4.63652 9.49609 4.63652 8.50391 4.73027 8.04688C5.18339 5.89062 6.80449 4.28906 8.9373 3.88672C9.4373 3.78906 10.2732 3.78906 10.7732 3.88672C12.6561 4.24609 14.199 5.57812 14.7928 7.36719C14.9998 7.98438 15.0428 8.28125 15.0506 9.01562L15.0545 9.69531L15.7771 10.8984C16.1717 11.5625 16.5154 12.1016 16.535 12.0938C16.5936 12.0781 16.8592 11.3711 16.9803 10.9023L17.0896 10.4883L17.7381 10.4766C18.6248 10.4648 18.5467 10.6016 18.5467 9.03906C18.5467 8.22656 18.531 7.78516 18.5037 7.72266C18.4334 7.56641 18.3123 7.53906 17.6717 7.53906H17.074L17.0467 7.37891C16.9686 6.89062 16.5545 5.83984 16.2146 5.27344L16.0154 4.94141L16.4607 4.48828C16.8514 4.09375 16.9061 4.01953 16.9061 3.90625C16.9061 3.78516 16.824 3.69141 16.0193 2.88281C15.1092 1.96875 15.0154 1.89844 14.8279 1.99219C14.7771 2.01953 14.5545 2.22266 14.3279 2.44531L13.9139 2.85156L13.7264 2.73438C13.1951 2.39844 12.3084 2.02344 11.6717 1.86719L11.3201 1.78125V1.14453C11.3201 0.558594 11.3123 0.5 11.242 0.429688C11.1678 0.355469 11.1131 0.351562 9.85527 0.351562C8.59746 0.351562 8.54277 0.355469 8.46855 0.429688Z"
                  fill="#0078BD"
                />
                <path
                  d="M12.9964 10.0234C13.2582 10.1562 13.3988 10.3594 13.4222 10.6367C13.4339 10.8203 13.1488 15.3242 13.0941 15.7383C13.0472 16.0898 12.6996 16.2891 12.3636 16.1562C12.1683 16.0781 12.0628 15.9453 12.0355 15.75C12.0277 15.6719 11.9418 14.4961 11.848 13.1367C11.6605 10.3672 11.6566 10.4414 11.9222 10.1758C12.1996 9.90234 12.6253 9.83984 12.9964 10.0234ZM12.8832 17.2266C13.3753 17.4766 13.3714 18.1875 12.8753 18.4414C12.6722 18.543 12.348 18.5312 12.1878 18.4102C11.8363 18.1523 11.7777 17.7031 12.0511 17.3789C12.2503 17.1445 12.598 17.082 12.8832 17.2266Z"
                  fill="#0078BD"
                />
              </svg>
            ),
          },
          {
            title: "Total RPM",
            value: "0.00",
            icon: (
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M9.15929 5.4375C6.65148 5.6875 4.3546 7.08203 2.96398 9.1875C2.33117 10.1484 1.84288 11.4141 1.67882 12.5C1.65538 12.6602 1.62804 12.8516 1.61632 12.918C1.6046 13.0117 1.61242 13.0469 1.65148 13.0469C1.68663 13.0469 1.7296 12.9375 1.77257 12.7266C1.93663 11.9766 2.35851 10.9883 2.7921 10.3516C4.00304 8.57031 5.90929 7.46484 8.0382 7.30859C10.0655 7.15625 12.1671 7.99609 13.5382 9.50781C13.6866 9.67188 13.8234 9.80469 13.8468 9.80469C13.8898 9.80469 16.5773 8.76562 16.6749 8.71484C16.7843 8.65234 15.964 7.77344 15.2726 7.21484C13.6319 5.89062 11.3273 5.21875 9.15929 5.4375Z"
                  fill="#0078BD"
                />
                <path
                  d="M13.6211 10.5273L10 11.9453L9.63672 11.9414C9.17969 11.9375 8.91016 12.0352 8.64062 12.2969C8.34375 12.5898 8.26172 12.793 8.26172 13.2617C8.26172 13.5898 8.27734 13.6797 8.35156 13.832C8.49609 14.125 8.69141 14.3203 8.97656 14.4609C9.21094 14.5781 9.26953 14.5898 9.57031 14.5898C9.84375 14.5898 9.94141 14.5703 10.1172 14.4883C10.4141 14.3516 10.5898 14.1875 10.7344 13.9141L10.8594 13.6797L13.582 11.793C15.082 10.7578 16.5352 9.74609 16.8164 9.55469C17.2734 9.23438 17.375 9.13672 17.2773 9.11719C17.2617 9.11328 15.6172 9.75 13.6211 10.5273Z"
                  fill="#0078BD"
                />
                <path
                  d="M16.1445 10.7148C15.4531 11.1914 14.8867 11.6055 14.8828 11.6367C14.8828 11.6641 14.9258 11.8086 14.9766 11.9492C15.1094 12.3203 15.2734 13.0703 15.3008 13.4492C15.3125 13.625 15.3398 13.8086 15.3555 13.8555L15.3906 13.9453H16.8516C18.1094 13.9453 18.3164 13.9375 18.3594 13.8867C18.4687 13.7578 18.3281 12.3867 18.125 11.5898C17.9648 10.957 17.5234 9.84375 17.4297 9.84375C17.4141 9.84375 16.8359 10.2344 16.1445 10.7148Z"
                  fill="#0078BD"
                />
              </svg>
            ),
          },
          {
            title: "Total PR1",
            value: "0.00",
            icon: (
              <svg
                width="21"
                height="20"
                viewBox="0 0 21 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g clipPath="url(#clip0_915_7372)">
                  <path
                    d="M18.0508 0.078125C17.2617 0.285156 16.3555 0.839844 15.5469 1.62109C15.2109 1.94141 14.6445 2.58984 14.582 2.72266C14.582 2.72656 13.7891 2.54688 12.8242 2.32422L11.0664 1.91797L5.78125 7.19922C2.87891 10.1055 0.5 12.4961 0.5 12.5195C0.5 12.5703 7.92969 20 7.98047 20C8.00391 20 10.3984 17.6211 13.3008 14.7188L18.582 9.43359L18.1797 7.67578C17.9531 6.71094 17.7734 5.91797 17.7773 5.91406C17.7812 5.91406 17.9336 5.79688 18.1172 5.65625C19.2539 4.78125 20.1602 3.5 20.4219 2.40625C20.5195 2.01172 20.5234 1.42969 20.4375 1.12891C20.2812 0.601562 19.8945 0.226562 19.332 0.0625C19.0352 -0.0234375 18.4141 -0.015625 18.0508 0.078125ZM19.0977 1.26953C19.5156 1.48828 19.2539 2.52734 18.5352 3.5C18.4258 3.64844 18.1445 3.96094 17.9062 4.19922L17.4766 4.62891L17.4297 4.43359C17.4023 4.32422 17.3359 4.03516 17.2773 3.78516L17.1758 3.32812L16.7969 3.24219C16.5898 3.19531 16.2969 3.12891 16.1523 3.08984L15.8828 3.02734L16.1445 2.74609C17.1211 1.6875 18.5391 0.980469 19.0977 1.26953ZM12.7539 3.55859C13.4141 3.71094 13.9609 3.83984 13.9648 3.84375C13.9688 3.84766 13.9258 3.99219 13.8711 4.16016C13.7812 4.43359 13.7656 4.53906 13.7656 5C13.7617 5.57422 13.8086 5.77734 14.0117 6.07422C14.2031 6.35547 14.2031 6.35547 14.6602 5.89453L15.0742 5.48438L15.0156 5.36719C14.9805 5.30469 14.9531 5.15625 14.9531 5.03125C14.9531 4.78125 15.125 4.1875 15.2031 4.15625C15.2422 4.14062 16.1211 4.32031 16.1523 4.34766C16.1562 4.35156 16.4023 5.41406 16.6992 6.70703L17.2422 9.05859L16.7734 9.52734L16.3008 10L13.4102 7.10938L10.5195 4.21875L10.9883 3.75C11.2461 3.49219 11.4766 3.28125 11.5039 3.28125C11.5273 3.28125 12.0898 3.40625 12.7539 3.55859ZM11.7227 14.5781L8 18.3008L5.10938 15.4102L2.21875 12.5195L5.9375 8.80078L9.66016 5.07812L12.5508 7.96875L15.4414 10.8594L11.7227 14.5781Z"
                    fill="#0078BD"
                  />
                  <path
                    d="M10.8281 8.79297L10.3945 9.22656L10.2578 9.18359C9.56641 8.95703 8.80859 9.13672 8.34766 9.64062C7.71875 10.3281 7.70703 11.332 8.32812 12.0703C8.42578 12.1875 8.51953 12.3438 8.53125 12.4141C8.61328 12.8516 8.14844 13.2148 7.75 13.0273C7.55859 12.9375 7.44531 12.7656 7.42188 12.5352C7.40625 12.3477 7.39844 12.3438 7.24219 12.3008C6.61719 12.1289 6.25781 12.043 6.24219 12.0586C6.23047 12.0664 6.22266 12.2734 6.22266 12.5117C6.22656 12.8438 6.24219 12.9883 6.29297 13.1055L6.36328 13.2578L5.90234 13.7188L5.44141 14.1797L5.88281 14.6172L6.32031 15.0586L6.77734 14.6016L7.23828 14.1484L7.39453 14.207C7.61719 14.2891 8.09766 14.3164 8.35938 14.2617C9.00391 14.125 9.53516 13.6133 9.70312 12.9688C9.82422 12.4883 9.71875 11.8711 9.45312 11.5195C9.39453 11.4414 9.28906 11.3047 9.22266 11.2109C8.92188 10.8164 9.16406 10.3125 9.64844 10.3125C9.96484 10.3125 10.1875 10.5391 10.2031 10.875L10.2109 11.0352L10.7695 11.1836C11.1523 11.2852 11.3438 11.3203 11.3711 11.293C11.4375 11.2266 11.4219 10.5898 11.3438 10.3359L11.2773 10.1055L11.707 9.67188C11.9453 9.43359 12.1406 9.21875 12.1406 9.19922C12.1406 9.14844 11.3516 8.35938 11.3008 8.35938C11.2773 8.35938 11.0664 8.55469 10.8281 8.79297Z"
                    fill="#0078BD"
                  />
                </g>
                <defs>
                  <clipPath id="clip0_915_7372">
                    <rect width="20" height="20" fill="white" transform="translate(0.5)" />
                  </clipPath>
                </defs>
              </svg>
            ),
          },
          {
            title: "Total Earnings",
            value: "$0.00",
            icon: (
              <svg
                width="22"
                height="22"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20Z"
                  fill="#0078BD"
                />
                <path
                  d="M13.5 7H10.5C10.09 7 9.75 7.34 9.75 7.75V16.25C9.75 16.66 10.09 17 10.5 17H13.5C13.91 17 14.25 16.66 14.25 16.25V7.75C14.25 7.34 13.91 7 13.5 7Z"
                  fill="#0078BD"
                />
                <path
                  d="M12.75 9.5H15.25C15.66 9.5 16 9.84 16 10.25V13.75C16 14.16 15.66 14.5 15.25 14.5H12.75C12.34 14.5 12 14.16 12 13.75V10.25C12 9.84 12.34 9.5 12.75 9.5Z"
                  fill="#0078BD"
                />
                <path
                  d="M11.25 9.5H8.75C8.34 9.5 8 9.84 8 10.25V13.75C8 14.16 8.34 14.5 8.75 14.5H11.25C11.66 14.5 12 14.16 12 13.75V10.25C12 9.84 11.66 9.5 11.25 9.5Z"
                  fill="#0078BD"
                />
              </svg>
            ),
          },
        ]);
      }
    } catch (error) {
      console.error("Error fetching stats:", error);
      setStats(null);
    } finally {
      setLoading(false);
    }
  };

  // Re-fetch when fromDate or toDate changes (unchanged)
  useEffect(() => {
    if (fromDate) {
      fetchStats();
    }
  }, [fromDate, toDate]);

  return (
    <div className="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-5 gap-4 sm:gap-6 mb-10">
      {loading
        ? Array(5)
            .fill(0)
            .map((_, index) => (
              <ShimmerCard key={index} />
            ))
        : stats?.map((stat, index) => (
            <div
              key={index}
              className="bg-white px-[14px] py-[24px] rounded-xl shadow hover:shadow-lg transition flex items-center justify-between dark:bg-[#101935] dark:border-1 dark:border-[#263463]"
            >
              <div>
                <h3 className="text-[12px] sm:text-[16px] robotomedium text-[#333333B2] dark:text-[#95A0C6]">
                  {stat.title}
                </h3>
                <p className="text-[18px] sm:text-2xl font-bold mt-2 text-gray-900 dark:text-white">
                  {stat.value}
                </p>
              </div>
              <div className="bg-[#778da93f] h-[40px] w-[40px] rounded-full flex items-center justify-center">
                {stat.icon}
              </div>
            </div>
          ))}
    </div>
  );
};

export default StatsCards;